## Setup

Use `ACCOUNTADMIN` (or a similarly privileged role) to create all required objects. Then grant a dedicated role (DOC_AI_ROLE) to your user for running the lab.

Use the following sql code and modify as required.

```sql
-- 1. Switch to ACCOUNTADMIN (or equivalent)
USE ROLE ACCOUNTADMIN;

-- 2. Create database and schema if they do not exist
CREATE DATABASE IF NOT EXISTS RESUMES_HOL;
CREATE SCHEMA IF NOT EXISTS RESUMES_HOL.PUBLIC;

-- 3. Create a stage for uploading resumes
CREATE OR REPLACE STAGE RESUMES_HOL.PUBLIC.RESUMES
  DIRECTORY = ( ENABLE = true )
  ENCRYPTION = ( TYPE = 'SNOWFLAKE_SSE' );

-- 4. Create a dedicated role for Document AI
CREATE OR REPLACE ROLE DOC_AI_ROLE;

-- 5. Grant warehouse privileges to the role
GRANT USAGE, OPERATE ON WAREHOUSE COMPUTE_WH TO ROLE DOC_AI_ROLE;

-- 6. Grant Document AI Creator privileges to the role
GRANT DATABASE ROLE SNOWFLAKE.DOCUMENT_INTELLIGENCE_CREATOR TO ROLE DOC_AI_ROLE;

-- 7. Grant object privileges to DOC_AI_ROLE
GRANT USAGE ON DATABASE RESUMES_HOL TO ROLE DOC_AI_ROLE;
GRANT USAGE ON SCHEMA RESUMES_HOL.PUBLIC TO ROLE DOC_AI_ROLE;
GRANT READ ON STAGE RESUMES_HOL.PUBLIC.RESUMES TO ROLE DOC_AI_ROLE;
GRANT CREATE STREAM, CREATE TABLE, CREATE TASK, CREATE VIEW ON SCHEMA RESUMES_HOL.PUBLIC TO ROLE DOC_AI_ROLE;
GRANT CREATE STAGE ON SCHEMA RESUMES_HOL.PUBLIC TO ROLE DOC_AI_ROLE;
GRANT CREATE SNOWFLAKE.ML.DOCUMENT_INTELLIGENCE ON SCHEMA RESUMES_HOL.PUBLIC TO ROLE DOC_AI_ROLE;
GRANT CREATE STREAMLIT ON SCHEMA RESUMES_HOL.PUBLIC TO ROLE DOC_AI_ROLE;
GRANT EXECUTE TASK ON ACCOUNT TO ROLE DOC_AI_ROLE;

-- 8. Grant the role to your user
GRANT ROLE DOC_AI_ROLE TO USER <your_username>;

-- 9. Optional: allow ACCOUNTADMIN to select future tables
GRANT SELECT ON FUTURE TABLES IN DATABASE RESUMES_HOL TO ROLE ACCOUNTADMIN;
```
